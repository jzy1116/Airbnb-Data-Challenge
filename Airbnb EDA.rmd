---
title: "Airbnb EDA"
author: "Ziyu Jin"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 3
    toc_float: yes
  # pdf_document: 
  #   latex_engine: xelatex
---

```{r setup, include=FALSE}
# Clear environment of variables and functions
rm(list = ls(all = TRUE)) 

# Clear environment of packages
if(is.null(sessionInfo()$otherPkgs) == FALSE) {
  lapply(paste("package:", names(sessionInfo()$otherPkgs), sep=""), 
         detach, character.only = TRUE, unload = TRUE)
}
```

```{r}
#install.packages("dplyr")
library(dplyr)
library(DataCombine)
#library(vcd)
#library(ggmosaic)
```


```{r}
df <- read.csv("airbnb.csv")
#df <- filter(df, successful_booking == "yes")
df <- filter(df, !channel == "instant_book")
#
```

```{r}

df$channel = factor(df$channel, levels = c('contact_me', 'book_it'))
levels(df$channel)
```

```{r}
df$interactions  = factor(df$interactions, levels=c('<=3','4-5','6-8','9-10','11-15','16-20','21-25','26-30','>30'))
df$reviews  = factor(df$reviews, levels=c('0','1-5','6-10','11-15','16-20','21-30','31-50','51-100','>100'))
df$lead_time_in_days  = factor(df$lead_time_in_days, levels=c('<=1d','2-3d','4-7d','8-15d','16-20d','21-25d','26-30d','31-40d','41-50dw','51-60d','61-80d','81-100d','101-120d','121-150d','151-180d','181-200d','201-240d','>240d'))
df$duration_of_stay  = factor(df$duration_of_stay, levels=c('1d','2-3d','4-5d','6-7d','8-10d','11-15d','16-20d','21-30d','>30d'))
#df$words_guest  = factor(df$words_guest, levels=c('<=1','1-10','10-20','20-50','50-100','100-200','>200'))
df$words_host  = factor(df$words_host, levels=c('<=1','2-10','11-20','21-30','31-40','41-50','51-60','61-70','71-80','81-90','91-100','101-120','121-140','141-160','161-180','181-200','201-220','221-250','>250'))
df$message_length_in_char  = factor(df$message_length_in_char, levels=c('<=1','2-20','21-50','51-100','101-150','151-200','201-250','251-300','301-400','401-500','>500'))
df$reply_t_in_m  = factor(df$reply_t_in_m, levels=c('<=1m','2-10m','11-30m','31m-1h','1h-3h','3-6h','6-12h','12-24h','1-2d','>2d'))
df$accept_t_in_m  = factor(df$accept_t_in_m, levels=c('<=1m','2-10m','11-30m','31m-1h','1h-3h','3-6h','6-12h','12-24h','1-2d','>2d'))
df$guest_size_bin  = factor(df$guest_size_bin, levels=c('1','2','3-4','5-6','7-8','9-10','>10'))
#df$channel  = factor(df$channel, levels=c('contact_me','book_it','instant_book'))
#df$room_type  = factor(df$channel, levels=c('Shared room','Private room','Entire home/apt'))
#df <- DropNA(df, Var="room_type", message = TRUE)
#names(df)[names(df) == "lead_time_in_weeks"] <- "lead_time_in_days"
```


```{r}
# interactions
#mosaicplot(~ interactions + channel + successful_booking, data = df, cex.axis = 0.85, color = FALSE)
mosaicplot(~ interactions + message_length_in_char + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
#mosaicplot(~ interactions + reply_t_in_m + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ interactions + duration_of_stay + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ lead_time_in_days + interactions + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ interactions + reviews + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
```


```{r}
# user stage
mosaicplot(~ user_stage + message_length_in_char + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ user_stage + duration_of_stay + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ user_stage + channel + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
```

```{r}
# channel 
mosaicplot(~ channel + duration_of_stay + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ channel + reviews + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
mosaicplot(~ channel + guest_size_bin + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
```


```{r}
# stay
mosaicplot(~ duration_of_stay + message_length_in_char + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
```

```{r}
# message
mosaicplot(~ message_length_in_char + guest_size_bin + successful_booking, data = df, cex.axis = 0.85, color = TRUE)
```






























